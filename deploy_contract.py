from web3 import Web3
import json

#node_url = "https://ropsten.infura.io/v3/eaf5e0b4a01042a48211762c8d4eec44"
node_url = "http://"
web3 = Web3(Web3.HTTPProvider(node_url))

print(web3.isConnected())
print(web3.eth.blockNumber)

owner = "0xa1138fccd5f8E126E8d779CF78a547517307559d"
#address = "0x23da3e3Cd9400B624169b76A87325e4E4F7bC0E0"
balance = web3.eth.getBalance(owner)
print(balance)

#web3.defaultAccount
# PRIVATE_KEY_1 = to_bytes(
#     hexstr='0x6a8b4de52b288e111c14e1c4b868bc125d325d40331d86d875a3467dd44bf829')
# #web3.eth.defaultAccount =


with open("build/contracts/Demonstrate.json", "r") as f:
    _json = json.load(f)
    #print(_json["abi"])
    abi = _json["abi"]

    #bytecode = compiled_sol['contracts']['demonstrate.sol']['Demonstrate']['evm']['bytecode']['object']
    #bytecode = "0x608060405234801561001057600080fd5b50610e12806100206000396000f3fe60806040526004361061004a5760003560e01c806357caa7641461004f57806396324bd4146102f75780639d099e6e146103ab578063e1152343146104a7578063f14faf6f146104d5575b600080fd5b6102e1600480360360c081101561006557600080fd5b8101908080359060200190929190803590602001909291908035906020019064010000000081111561009657600080fd5b8201836020820111156100a857600080fd5b803590602001918460018302840111640100000000831117156100ca57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561012d57600080fd5b82018360208201111561013f57600080fd5b8035906020019184600183028401116401000000008311171561016157600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290803590602001906401000000008111156101c457600080fd5b8201836020820111156101d657600080fd5b803590602001918460018302840111640100000000831117156101f857600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561025b57600080fd5b82018360208201111561026d57600080fd5b8035906020019184600183028401116401000000008311171561028f57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050610503565b6040518082815260200191505060405180910390f35b34801561030357600080fd5b506103306004803603602081101561031a57600080fd5b81019080803590602001909291905050506107a1565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610370578082015181840152602081019050610355565b50505050905090810190601f16801561039d5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156103b757600080fd5b506103e4600480360360208110156103ce57600080fd5b8101908080359060200190929190505050610860565b60405180806020018681526020018581526020018481526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828103825287818151815260200191508051906020019080838360005b8381101561046857808201518184015260208101905061044d565b50505050905090810190601f1680156104955780820380516001836020036101000a031916815260200191505b50965050505050505060405180910390f35b6104d3600480360360208110156104bd57600080fd5b810190808035906020019092919050505061095b565b005b610501600480360360208110156104eb57600080fd5b8101908080359060200190929190505050610acc565b005b600042871161055d576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526028815260200180610d956028913960400191505060405180910390fd5b8686116105b5576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401808060200182810382526021815260200180610dbd6021913960400191505060405180910390fd5b606060036040519080825280602002602001820160405280156105ec57816020015b60608152602001906001900390816105d75790505b50905084816000815181106105fd57fe5b6020026020010181905250838160018151811061061657fe5b6020026020010181905250828160028151811061062f57fe5b602002602001018190525060006040518060c001604052808881526020018a81526020018981526020018381526020013481526020013373ffffffffffffffffffffffffffffffffffffffff168152509080600181540180825580915050906001820390600052602060002090600602016000909192909190915060008201518160000190805190602001906106c6929190610c1b565b50602082015181600101556040820151816002015560608201518160030190805190602001906106f7929190610c9b565b506080820151816004015560a08201518160050160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505050507f58dcb7e0024669b4d6a397c08f88007ee32c057f22b108eb44a8cd805de37f816001600080549050036040518082815260200191505060405180910390a16001600080549050039150509695505050505050565b600181815481106107ae57fe5b90600052602060002001600091509050806000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156108565780601f1061082b57610100808354040283529160200191610856565b820191906000526020600020905b81548152906001019060200180831161083957829003601f168201915b5050505050905081565b6000818154811061086d57fe5b9060005260206000209060060201600091509050806000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156109195780601f106108ee57610100808354040283529160200191610919565b820191906000526020600020905b8154815290600101906020018083116108fc57829003601f168201915b5050505050908060010154908060020154908060040154908060050160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905085565b803373ffffffffffffffffffffffffffffffffffffffff166000828154811061098057fe5b906000526020600020906006020160050160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614610a3b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600a8152602001807f4f6e6c79206f776e65720000000000000000000000000000000000000000000081525060200191505060405180910390fd5b6000808381548110610a4957fe5b90600052602060002090600602016004015490506000808481548110610a6b57fe5b9060005260206000209060060201600401819055503373ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f19350505050158015610ac6573d6000803e3d6000fd5b50505050565b600073ffffffffffffffffffffffffffffffffffffffff1660008281548110610af157fe5b906000526020600020906006020160050160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161415610bad576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260158152602001807f496e76616c69642064656d6f6e7374726174696f6e000000000000000000000081525060200191505060405180910390fd5b3460008281548110610bbb57fe5b9060005260206000209060060201600401600082825401925050819055507f7f33cc4ff9ec616b18266ccfe9acb607a1f8b1fb7e411b9a9b9dc03df1fb548a8134604051808381526020018281526020019250505060405180910390a150565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10610c5c57805160ff1916838001178555610c8a565b82800160010185558215610c8a579182015b82811115610c89578251825591602001919060010190610c6e565b5b509050610c979190610cfb565b5090565b828054828255906000526020600020908101928215610cea579160200282015b82811115610ce9578251829080519060200190610cd9929190610c1b565b5091602001919060010190610cbb565b5b509050610cf79190610d20565b5090565b610d1d91905b80821115610d19576000816000905550600101610d01565b5090565b90565b610d4991905b80821115610d455760008181610d3c9190610d4c565b50600101610d26565b5090565b90565b50805460018160011615610100020316600290046000825580601f10610d725750610d91565b601f016020900490600052602060002090810190610d909190610cfb565b5b5056fe44656d6f6e7374726174696f6e73206e65656420746f20626520696e20746865206675747572652e456e642074696d65206d7573742062652061667465722073746172742074696d65a265627a7a72305820032e2016ddfbe237e1e69f2ecbdd16c15fbfdfdbd686cfddb40b9b78b7a8094264736f6c634300050a0032"
    bytecode = _json["bytecode"]
    print(bytecode)

    Ddemonstrate = web3.eth.contract(abi=abi, bytecode=bytecode)
    tx_hash = Ddemonstrate.constructor().transact()


    tx = erc20.functions.mint(1,).buildTransaction({'chainId': 1,'gas': 70000,'gasPrice': w3.toWei('1', 'gwei'),'nonce': nonce})
    #private_key = b"\xb2\\}\xb3\x1f\xee\xd9\x12''\xbf\t9\xdcv\x9a\x96VK-\xe4\xc4rm\x03[6\xec\xf1\xe5\xb3d"
    private_key = ""
    signed_txn = web3.eth.account.signTransaction(mint_txn, private_key=private_key)

    print(signed_txn)